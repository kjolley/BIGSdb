var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Object.is",function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,c){var b=this;b instanceof String&&(b=String(b));var e=b.length;for(c=c||0;c<e;c++)if(b[c]==a||Object.is(b[c],a))return!0;return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,c||0)}},"es6","es3");
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
$(function(){var a=$("#layout").val(),b=$("#fill_gaps").prop("checked");try{var c=(new Muuri(".grid",{dragEnabled:!0,layout:{alignRight:a.includes("right"),alignBottom:a.includes("bottom"),fillGaps:b},dragStartPredicate:function(a,c){return enable_drag}})).on("move",function(){saveLayout(c)});order&&loadLayout(c,order)}catch(d){console.log(d.message)}$("#panel_trigger,#close_trigger").click(function(){$("#modify_panel").toggle("slide",{direction:"right"},"fast");$("#panel_trigger").show();return!1});
$("#panel_trigger").show();$(document).mouseup(function(a){var c=$("#modify_panel");c.is(a.target)||0!==c.has(a.target).length||c.hide()});$("#layout").change(function(){a=$("#layout").val();try{c._settings.layout.alignRight=a.includes("right"),c._settings.layout.alignBottom=a.includes("bottom"),c.layout()}catch(d){}$.ajax(url+"&page=dashboard&updatePrefs=1&attribute=layout&value="+a)});$("#fill_gaps").change(function(){b=$("#fill_gaps").prop("checked");try{c._settings.layout.fillGaps=b,c.layout()}catch(d){}$.ajax(url+
"&page=dashboard&updatePrefs=1&attribute=fill_gaps&value="+(b?1:0))});$("#enable_drag").change(function(){enable_drag=$("#enable_drag").prop("checked");$.ajax(url+"&page=dashboard&updatePrefs=1&attribute=enable_drag&value="+(enable_drag?1:0))});$("#edit_elements").change(function(){var a=$("#edit_elements").prop("checked");$.ajax(url+"&page=dashboard&updatePrefs=1&attribute=edit_elements&value="+(a?1:0));$("span.dashboard_edit_element").css("display",a?"inline":"none")});$("#remove_elements").change(function(){var a=
$("#remove_elements").prop("checked");$.ajax(url+"&page=dashboard&updatePrefs=1&attribute=remove_elements&value="+(a?1:0));$("span.dashboard_remove_element").css("display",a?"inline":"none")});$("#include_old_versions").change(function(){var a=$("#include_old_versions").prop("checked");$.ajax({url:url+"&page=dashboard&updatePrefs=1&attribute=include_old_versions&value="+(a?1:0)}).done(function(){reloadAllElements(c)})});$("#add_element").click(function(){var a=getNextid();addElement(c,a)});$("div#dashboard").on("click",
".dashboard_edit_element",function(){var a=$(this).attr("data-id");editElement(c,a)});$("div#dashboard").on("click",".dashboard_remove_element",function(){var a=$(this).attr("data-id");removeElement(c,a)});$("div#dashboard").on("click",".setup_element",function(){var a=$(this).attr("data-id");setupElement(c,a)});$("div#dashboard").on("click",".dashboard_explore_element",function(){var a=$(this).attr("data-id");elements[a].url&&(window.location.href=elements[a].url)});applyFormatting();["width","height"].forEach(function(a){$(document).on("change",
"."+a+"_select",function(b){b=$(this).attr("id").replace("_"+a,"");changeElementDimension(c,b,a)})});$(document).on("change",".element_option",function(a){var b=$(this).attr("id");a=b.replace(/^\d+_/,"");b=b.replace("_"+a,"");changeElementAttribute(c,b,a,$(this).val())});$("a#dashboard_toggle").on("click",function(){$.get(url+"&page=dashboard&updatePrefs=1&attribute=default&value=0",function(){window.location=url})})});
function changeElementAttribute(a,b,c,d){elements[b][c]=d;$.post(url,{db:instance,page:"dashboard",updatePrefs:1,attribute:"elements",value:JSON.stringify(elements)},function(){reloadElement(a,b)})}function applyFormatting(){fitty(".dashboard_big_number",{maxSize:64})}function getNextid(){return 0===Object.keys(elements).length?1:Math.max.apply(Math,[].concat($jscomp.arrayFromIterable(Object.keys(elements))))+1}
function addElement(a,b){0===Object.keys(elements).length&&$("div#empty").html("");var c=url+"&page=dashboard&new="+b,d=$("#add_field").val();d&&(c+="&field="+d);$.get(c,function(c){try{var d=document.createRange().createContextualFragment(JSON.parse(c).html);b in elements||(a.add([d.firstChild]),elements[b]=JSON.parse(c).element,saveElements(a));applyFormatting()}catch(g){console.log(g.message)}})}
function editElement(a,b){$("span#control_"+b).hide();$("span#wait_"+b).show();$.get(url+"&page=dashboard&control="+b,function(a){$(a).appendTo("body").modal();$("span#control_"+b).show();$("span#wait_"+b).hide()})}function reloadElement(a,b){$.get(url+"&page=dashboard&element="+b,function(a){try{$("div#element_"+b+"> .item-content > .ajax_content").html(JSON.parse(a).html),elements[b]=JSON.parse(a).element,applyFormatting()}catch(d){console.log(d.message)}})}
function reloadAllElements(a){$.each(Object.keys(elements),function(b,c){reloadElement(a,c)})}function removeElement(a,b){var c=a.getItem($("div#element_"+b)[0]);a.remove([c],{removeElements:!0});delete elements[b];saveElements(a);0==Object.keys(elements).length&&$("div#empty").html(empty)}function setupElement(a,b){$.get(url+"&page=dashboard&setup="+b,function(a){$(a).appendTo("body").modal()})}
function changeElementDimension(a,b,c){var d=$("div.item[data-id='"+b+"'] > div.item-content"),e=d.attr("class").split(/\s+/);$.each(e,function(a,b){b.includes("dashboard_element_"+c)&&d.removeClass(b)});e=$("input[name='"+b+"_"+c+"']:checked").val();d.addClass("dashboard_element_"+c+e);$("span#"+b+"_"+c).html(e);elements[b][c]=Number(e);$.post(url,{db:instance,page:"dashboard",updatePrefs:1,attribute:"elements",value:JSON.stringify(elements)});applyFormatting();a.refreshItems().layout()}
function saveElements(a){$.post(url,{db:instance,page:"dashboard",updatePrefs:1,attribute:"elements",value:JSON.stringify(elements)});saveLayout(a)}function serializeLayout(a){a=a.getItems().map(function(a){return a.getElement().getAttribute("data-id")});return JSON.stringify(a)}
function loadLayout(a,b){b=JSON.parse(b);for(var c=a.getItems(),d=c.map(function(a){return a.getElement().getAttribute("data-id")}),e=[],f,g=0;g<b.length;g++)f=b[g],f=d.indexOf(f),-1<f&&e.push(c[f]);a.sort(e,{layout:"instant"})}function saveLayout(a){a=serializeLayout(a);$.post(url,{db:instance,page:"dashboard",updatePrefs:1,attribute:"order",value:a})}
function resetDefaults(){$("#modify_panel").toggle("slide",{direction:"right"},"fast");$.get(url+"&resetDefaults=1",function(){$("#layout").val("left-top");$("#fill_gaps").prop("checked",!0);$("#edit_elements").prop("checked",!1);$("#remove_elements").prop("checked",!1);location.reload()})};
//# sourceMappingURL=bigsdb.dashboard.min.js.map
